/*!
* Application.js by @jasonT
* Copyright 2013 Webxpress, Inc
* http://www.webxpress.co
*/
(function(e){"use strict";e(function(){var t={};t.global={init:function(){t.global.tooltip();t.global.datepicker();t.global.radiobutton();t.global.submitform()},tooltip:function(){e(".helptip").tooltip()},datepicker:function(){e("#date").datepicker()},radiobutton:function(){e("button.radio").click(function(){e("input[name=gender]").val(e(this).val())})},submitform:function(){e("form input, form select").hover(function(){e(this).popover("show")}).mouseout(function(){e(this).popover("hide")});if(e("form").hasClass("global")){e("form").validate({rules:{email:{required:true,email:true},password:{required:true,minlength:6},re_password:{required:true,equalTo:"input[name=password]"}},errorClass:"help-inline",errorElement:"span",errorPlacement:function(t,n){if(e(n).parent().next().is("span.help-inline")){e(n).parent().next().remove()}e(n).parent().after(t)},highlight:function(t,n,r){e(t).parents(".control-group").removeClass("success");e(t).parents(".control-group").addClass("error")},unhighlight:function(t,n,r){e(t).parents(".control-group").removeClass("error");e(t).parents(".control-group").addClass("success")},submitHandler:function(t){e.ajax({url:APP.siteurl+e("input[name=action]").val(),type:"POST",dataType:"json",data:e(t).serialize(),beforeSend:function(){e("button[type=submit]").button("loading");e(t).children("div.alert").remove();e(t).children(".control-group").removeClass("success error")},success:function(n){e("button[type=submit]").button("reset");if(n.error){e(t).prepend('<div class="alert alert-error"><button data-dismiss="alert" class="close" type="button">×</button>'+n.msg+"</div>")}else{if(e(t).has("input[name=redirect]").length){e(t).prepend('<div class="alert alert-success"><button data-dismiss="alert" class="close" type="button">×</button>'+n.msg+"</div>")}else{window.location.href=e(t).attr("action")}}},error:function(){e("button[type=submit]").button("reset")}});return false}})}}};t.personal_id={init:function(){var t=this;if(typeof USER.login_count==="number"&&1===parseInt(USER.login_count)){if(typeof USER.session_popup==="number"&&1!==parseInt(USER.session_popup)){t.welcome_popup();t.session_popup()}}e("#birthday").click(function(){e("#date").datepicker("show")})},welcome_popup:function(){e("#welcome-popup").modal("show")},session_popup:function(){e.ajax({url:APP.ajaxurl+"/session_popup",type:"POST",dataType:"json",data:{csrf_token:e("input[name=csrf_token]").val()},beforeSend:function(){},success:function(e){},error:function(){}})}};t.my_details={init:function(){var e=this;e.save_popup_digital_prof_details()},save_popup_digital_prof_details:function(){e(".popup-profile").validate({rules:{email:{required:false,email:true}},errorClass:"help-inline",errorElement:"span",highlight:function(t,n,r){e(t).parents(".control-group").removeClass("success");e(t).parents(".control-group").addClass("error")},unhighlight:function(t,n,r){e(t).parents(".control-group").removeClass("error");e(t).parents(".control-group").addClass("success")},submitHandler:function(t){e(t).ajaxSubmit({target:".pop-message"});return false}})}};t.global.init();if(APP.controller=="digicard"&&APP.method=="personal_id"){t.personal_id.init()}if(APP.controller=="digicard"&&APP.method=="details"){t.my_details.init()}})})(jQuery)